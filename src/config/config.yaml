apps:
  cab:
    category: cab
    validation:
      name_match_threshold: 75
      name_match_required: false   # set false to skip name check
      address_match_threshold: 40
      address_match_required: false # set false to skip address check
      month_match_required: false # when false, skip month check
  meal:
    category: meal
    validation:
      name_match_threshold: 75
      name_match_required: false
      month_match_required: false
      vendor_match_threshold: 60
  fuel:
    category: fuel
    validation:
      name_match_threshold: 75
      name_match_required: false
      month_match_required: false

paths:
  clients_file: clients.json
  resources_dir: resources
  processed_dir: resources/processed_inputs   # local sync writes here; app can use --resources-dir <this>
  output_dir: resources/model_output         # extraction + decisions output (commute/meal/fuel, decisions, policy)

# SharePoint sync (used by scripts/sync_sharepoint_to_resources.py)
# Credentials: set env SHAREPOINT_USERNAME, SHAREPOINT_PASSWORD (required for user auth).
# Overrides: SHAREPOINT_SITE_URL and SHAREPOINT_ROOT override site_url and root_folder below.
sharepoint:
  site_url: ""                    # e.g. https://yourtenant.sharepoint.com/sites/YourSite
  root_folder: ""                 # server-relative path, e.g. /sites/YourSite/Shared Documents/Bills
  default_client: "unknown"       # used when client cannot be inferred from folder name
  default_month: "unknown"       # for local mode when month not in path
  employee_mapping_file: ""       # optional JSON path (project-relative): {"Display Name": "IIIPL-1234", ...}
  # Categories synced into paths.resources_dir: commute, meal, fuel (folder names normalized to {emp_id}_{emp_name}_{month}_{client})
  categories:
    commute:
      keywords: ["cab", "taxi", "commute", "ride", "uber", "ola", "transport","travel"]
    meal:
      keywords: ["meal", "meals", "food", "lunch", "dinner"]
    fuel:
      keywords: ["fuel", "petrol", "diesel", "gas"]
  # Map path substring (lowercase) -> client id for folder naming
  client_keywords:
    tesco: "tesco"
    amex: "amex"
    "american express": "amex"

# Validation: name mismatch, address mismatch, month mismatch (configurable per app under apps.<app>.validation)
validation:
  # Name match: fuzzy score (0-100) above this passes. Bill rider/buyer name vs employee name.
  name_match_threshold: 75
  # When false, name check is skipped (all bills pass name validation).
  name_match_required: true
  # Address match: fuzzy score (0-100) above this passes. Used for cab/commute (pickup/drop vs client addresses).
  address_match_threshold: 40
  # When false, address check is skipped (cab only).
  address_match_required: true
  # Month match: when true, bill date month must match folder emp_month; when false, month check is skipped.
  month_match_required: true
  manual_id_prefix: "MANUAL"
  date_format: "%d/%m/%Y"
  # Default per-bill cap (overridden by apps.meal/fuel.validation.amount_limit_per_bill). Null = no cap.
  amount_limit_per_bill: null

# Folder name parsing: {emp_id}_{emp_name}_{month}_{client}
folder_parser:
  separator: "_"
  min_parts: 4

# Bill file extensions when scanning folders
folder:
  bill_extensions: [".pdf", ".png", ".jpg", ".jpeg"]

# OCR (Tesseract) settings
ocr:
  tesseract:
    dpi: 300
    lang: "eng"

# LLM: change provider by setting 'provider' to one of the keys under 'providers'.
# API keys: set in .env (see .env.example). Config only lists env var names (api_key_env).
# Use provider: ollama for local models (no API key; run scripts/run_local_llm.sh first).
llm:
  provider: openai
  temperature: 0
  default_model: 
  providers:
    ollama:
      model: llama3.2              # e.g. llama3.2, mistral, codellama
      base_url: "http://localhost:11434"   # Ollama API (optional; default localhost:11434)
    groq:
      model: llama-3.3-70b-versatile
      api_key_env: GROQ_API_KEY
      api_key: ""
    openai:
      model: gpt-4o-mini
      api_key_env: OPENAI_API_KEY
      api_key: ""
    anthropic:
      model: claude-3-5-sonnet-20241022
      api_key_env: ANTHROPIC_API_KEY
      api_key: ""
    azure:
      model: gpt-4   # deployment name in Azure
      api_key_env: AZURE_OPENAI_API_KEY
      api_key: ""
      api_base_env: AZURE_OPENAI_ENDPOINT
      api_version: "2024-02-15-preview"
    huggingface:
      model: meta-llama/Llama-3.2-3B-Instruct   # Hugging Face Hub repo_id
      api_key_env: HUGGINGFACEHUB_API_TOKEN
      api_key: ""
      max_new_tokens: 1024

# Optional org API: employee details, leave, manager. Not mandatory; if disabled or API fails, flow continues.
org_api:
  enabled: false
  base_url: ""                    # e.g. https://your-org-api.example.com
  api_key_env: ORG_API_KEY        # env var for Bearer token (optional)
  employee_path: "/api/employees/{employee_id}"   # path template; {employee_id} is replaced
  timeout: 10

# RAG Configuration for Policy Extraction
# Set enabled: true to use vector-based semantic search for policy queries
rag:
  enabled: false                    # Toggle RAG on/off (default: false)
  chunk_size: 500                   # Size of text chunks for vectorization
  chunk_overlap: 50                 # Overlap between chunks
  top_k: 5                          # Number of relevant chunks to retrieve
  embedding_model: "sentence-transformers/all-MiniLM-L6-v2"  # HuggingFace embedding model
